<div *ngIf="loading" class="skeleton">Cargando...</div>

<table *ngIf="!loading && documents.length" class="table">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Estado</th>
      <th>Análisis</th>
      <th>Creado</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let d of documents" [routerLink]="['/documents', d.id]" style="cursor:pointer">
      <td class="cell-name" title="{{ d.name }}">
        <a [routerLink]="['/documents', d.id]">{{ d.name }}</a>
      </td>
      <td>
        <span class="chip"
          [ngClass]="{
            'chip--ok': d.status === 'created' || d.status === 'ready',
            'chip--pending': d.status === 'pending',
            'chip--done': d.status === 'signed' || d.status === 'completed',
            'chip--error': d.status === 'error' || d.status === 'failed'
          }"
        >{{ d.status || '—' }}</span>
      </td>
      <td>
        <ng-container *ngIf="d.has_analysis; else noAnalysis">
          <span class="chip" [ngClass]="riskClass(d.risk_score)">
            Score: {{ d.risk_score | number:'1.2-2' }}
          </span>
        </ng-container>
        <ng-template #noAnalysis>
          <span class="chip chip--pending">Sin análisis</span>
        </ng-template>
      </td>
      <td style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
        <span>{{ d.created_at | date:'medium' }}</span>
        <button mat-icon-button color="warn" aria-label="Eliminar" (click)="onDelete($event, d.id)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </tr>
  </tbody>
  
</table>

<div *ngIf="!loading && !documents.length" class="empty">Sin documentos</div>


