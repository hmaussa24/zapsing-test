<mat-card>
  <mat-card-header>
    <mat-card-title>Análisis</mat-card-title>
    <mat-card-subtitle>Resumen automático</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <mat-progress-spinner *ngIf="loading" diameter="18" mode="indeterminate"></mat-progress-spinner>
    <ng-container *ngIf="!loading">
      <div *ngIf="analysis; else noAnalysis">
        <p>{{ analysis?.summary }}</p>
        <p><strong>Riesgo:</strong> {{ analysis?.risk_score }}</p>
        <div *ngIf="analysis?.missing_topics">
          <h3>Temas faltantes</h3>
          <pre style="white-space: pre-wrap;">{{ analysis?.missing_topics }}</pre>
        </div>
        <div *ngIf="analysis?.insights">
          <h3>Insights</h3>
          <pre style="white-space: pre-wrap;">{{ analysis?.insights }}</pre>
        </div>
      </div>
      <ng-template #noAnalysis>
        <p class="text-muted">Sin análisis disponible aún.</p>
      </ng-template>
    </ng-container>
  </mat-card-content>
</mat-card>


